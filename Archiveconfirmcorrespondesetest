@ExtendWith(MockitoExtension.class)
class ArchiveConfirmCorrespondenceServiceTest {

    @Mock
    private ArchiveDocsRestService archiveDocsRestService;

    @Mock
    private RequestService requestService;

    @Mock
    private ClientParticipantInfoCache clientParticipantInfoCache;

    @Mock
    private SetItPullClientCache setItPullClientCache;

    @Mock
    @Qualifier("asyncExecutor")
    private Executor correspondenceExecutor;

    @InjectMocks
    private ArchiveConfirmCorrespondenceService archiveConfirmCorrespondenceService;

    @Test
    void testGetCorrespondenceDocs() {
        // Arrange
        Map<String, String> reqHeadersMap = Map.of("Authorization", "Bearer token", "UC-Vendor-ID", "SPSRWB", "UC-Plan-Id-List", "123,456");
        PartyInfo partyInfo = new PartyInfo("client123", "12345");
        Map<String, String> preAuthHeadersMap = Map.of("UC-Vendor-ID", "SPSRWB", "UC-Plan-Id-List", "123,456");

        Party party = Party.builder().partyId("12345").pptId("12345").build();
        Account account = new Account();
        account.setPlanType(CrspConstants.SAVINGS);
        account.setVoyaAccessPlan(false);
        account.setPlanId("123");

        List<Account> accountsList = List.of(account);
        Plan plan = new Plan();
        plan.setPlanId("123");

        List<Plan> filteredPlans = List.of(plan);
        ArchiveDocsInfo archiveDocsInfo = new ArchiveDocsInfo();
        List<ArchiveDocsInfo> archiveDocsInfos = List.of(archiveDocsInfo);

        CompletableFuture<List<ArchiveDocsInfo>> futureDocs = CompletableFuture.completedFuture(archiveDocsInfos);

        Mockito.when(requestService.getPreAuthHeadersMap(reqHeadersMap)).thenReturn(preAuthHeadersMap);
        Mockito.when(requestService.getAccountsList(party, preAuthHeadersMap)).thenReturn(accountsList);
        Mockito.when(archiveDocsRestService.getEaseCorrespondenceDocList("12345", plan, true))
                .thenReturn(archiveDocsInfos);

        // Act
        CorrespondenceResponse response = archiveConfirmCorrespondenceService.getCorrespondenceDocs(reqHeadersMap, partyInfo);

        // Assert
        Assertions.assertNotNull(response);
        Assertions.assertEquals(archiveDocsInfos, response.getArchiveDocsInfos());
    }
}
