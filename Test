@Test
void testFilterPlans_PrivateMethod() throws Exception {
    // Mock input
    Map<String, String> preAuthHeadersMap = Map.of(
        "UC_VENDOR_ID", "SPSRWB",
        "UC_PLAN_ID_LIST", "plan1,plan2"
    );
    String clientId = "client123";

    // Mock DocumentInfo and MailInfo
    DocumentInfo doc1 = mock(DocumentInfo.class);
    DocumentInfo doc2 = mock(DocumentInfo.class);
    when(doc1.getPlanId()).thenReturn("plan1");
    when(doc2.getPlanId()).thenReturn("plan3");
    MailInfo mailInfo = mock(MailInfo.class);
    when(mailInfo.getDocumentInfo()).thenReturn(List.of(doc1, doc2));
    List<MailInfo> mailInfoList = List.of(mailInfo);

    // Access private method using reflection
    Method filterPlansMethod = MailItConfirmCorrespondenceService.class.getDeclaredMethod(
        "filterPlans", List.class, Map.class, String.class
    );
    filterPlansMethod.setAccessible(true);

    // Invoke the private method
    List<MailInfo> result = (List<MailInfo>) filterPlansMethod.invoke(
        service, mailInfoList, preAuthHeadersMap, clientId
    );

    // Verify results
    assertNotNull(result);
    assertEquals(1, result.size());
    assertEquals(1, result.get(0).getDocumentInfo().size());
    assertEquals("plan1", result.get(0).getDocumentInfo().get(0).getPlanId());
}


@BeforeEach
void setup() {
    // Mock dependencies
    ClientParticipantInfoCache clientParticipantInfoCache = mock(ClientParticipantInfoCache.class);
    MailItPreferenceService mailItPreferenceService = mock(MailItPreferenceService.class);
    SetItPullClientCache setItPullClientCache = mock(SetItPullClientCache.class);
    RequestService requestService = mock(RequestService.class);

    // Create the service instance
    service = new MailItConfirmCorrespondenceService(
        clientParticipantInfoCache, mailItPreferenceService, setItPullClientCache, requestService
    );
}
